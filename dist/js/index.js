!function(s,e){function t(t){this.wrap=t,this.dataList=[],this.indexObj=null,this.rotateTimer=null}t.prototype={init(){this.getDom(),this.getData("../mock/data.json")},getDom(){this.record=document.querySelector(".songImg img"),this.controlBtns=document.querySelectorAll(".control li")},getData(t){var i=this;s.ajax({url:t,method:"get",success:function(t){i.dataList=t,i.listPlay(),i.indexObj=new e.controlIndex(t.length),i.loadMusic(i.indexObj.index),i.musicControl()},error:function(){}})},loadMusic(t){var i=this.dataList[t];e.render(i),e.music.load(i.audio),"play"==e.music.status&&(e.music.play(),this.controlBtns[2].classList.add("playing"),this.imgRotate(0)),this.list.changeSelect(t)},musicControl(){let i=this;this.controlBtns[1].addEventListener("touchend",function(){e.music.status="play",i.loadMusic(i.indexObj.prev())}),this.controlBtns[2].addEventListener("touchend",function(){var t;"play"==e.music.status?(e.music.pause(),this.classList.remove("playing"),i.imgStop()):(e.music.play(),this.classList.add("playing"),t=i.record.dataset.rotate||0,i.imgRotate(t))}),this.controlBtns[3].addEventListener("touchend",function(){e.music.status="play",i.loadMusic(i.indexObj.next())})},imgRotate(t){clearInterval(this.rotateTimer),this.rotateTimer=setInterval(()=>{t=+t+.2,this.record.style.transform=`rotate(${t}deg)`,this.record.dataset.rotate=t},1e3/60)},imgStop(t){clearInterval(this.rotateTimer)},listPlay(){let s=this;this.list=e.listControl(this.dataList,this.wrap),this.controlBtns[4].addEventListener("touchend",function(){s.list.slideUp()}),this.list.musicList.forEach((t,i)=>{t.addEventListener("touchend",function(){s.indexObj.index!=i&&(e.music.status="play",s.indexObj.index=i,s.loadMusic(i),s.list.slideDown())})})}},new t(document.getElementById("wrap")).init()}(window.Zepto,window.player);